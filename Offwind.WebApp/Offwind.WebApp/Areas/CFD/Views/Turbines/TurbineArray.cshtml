@section styles
{
    @Styles.Render("~/static/css/jquery.handsontable.full.css")
}
<div id="example1"></div>

@section scripts
{
    @Scripts.Render("~/static/js/jquery.handsontable.full.js")
    <script language="javascript">
        $(document).ready(function () {
            var renderer = function (instance, td) {
                Handsontable.TextCell.renderer.apply(this, arguments);
                $(td).css({ textAlign: "right" });
                return td;
            };
            var isInitialized = false;
            var $container = $("#example1");

            var changed = function(change, source) {
                if (!isInitialized) return;
                var d = $container.data('handsontable').getData();
                $.ajax({
                    url: "@Url.Action("TurbineCoordinatesSave", "WakeSimulation", new { area = "EngineeringTools" })",
                    dataType: "json",
                    type: "POST",
                    contentType: 'application/json; charset=utf-8',
                    data: JSON.stringify(d)
                });
            };

            $container.handsontable({
                startRows: 5,
                startCols: 2,
                columns: [{ type: { renderer: renderer} }, { type: { renderer: renderer} }],
                colHeaders: ["<b>X</b>", "<b>Y</b>"],
                rowHeaders: true,
                minSpareRows: 1,
                onChange: changed
            });

            $.ajax({
                url: "@Url.Action("TurbineCoordinatesData", "WakeSimulation", new { area = "EngineeringTools" })",
                dataType: 'json',
                type: 'GET',
                success: function (res) {
                    $container.data('handsontable').loadData(res);
                    isInitialized = true;
                }
            });
        });        
    </script>
}
